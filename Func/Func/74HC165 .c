/*********************************************************************************************************
* 文件名称：74HC165.c
* 摘    要：
* 当前版本：1.0.0
* 作    者：麦特实验室
* 完成日期：
* 内    容：
* 注    意：
* 开发环境：STC8A8K64S4A12@22.1184MHz芯片 & Keil uVision 5                                                                 
**********************************************************************************************************
* 取代版本：
* 作    者：
* 完成日期：
* 修改内容：
* 修改文件：
*********************************************************************************************************/

#include"Basic.h"
#include"74HC165.h"

/********************************
函数名称:delay_74HC165
函数功能:74HC165专用延时
输入参数:
输    入:
输出参数:
输    出:
********************************/
void delay_74HC165()
{
   _nop_(); 
   _nop_();
   _nop_();
   _nop_();	
}
/********************************
函数名称:Read74HC165
函数功能:读74HC165
输入参数:
输    入:
输出参数:74HC165的数据
输    出:
********************************/
u8 Read74HC165()
{  
   u8 i ,dat = 0;
   LD_74HC165 = 0;
   delay_74HC165();//短暂延时 产生一定宽度的脉冲
   LD_74HC165 = 1;//将外部信号全部读入锁存器中
   delay_74HC165();
   for(i=0; i<8; i++)
    { 
	  dat = dat << 1;//左移一位
	  CLK_74HC165  = 0;//时钟置0	 
      _nop_();
	  dat |= QH_74HC165;
      CLK_74HC165  = 1;//时钟置1	  
	} 
   
   return dat;	 
}
