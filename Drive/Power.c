/*------------------------------------------------------------------------------------------------------------------------
 * 文件名称：Power.c

 * 文件内容：电源管理

 * 文件版本：1.0.0

 * 文件作者：麦特实验室

 * 开发环境：STC8A8K64S4A12@22.1184MHz芯片 & Keil uVision 5 

 * 注    意：
------------------------------------------------------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------------------------------
                                                  加载头文件区
------------------------------------------------------------------------------------------------------------------------*/
#include "Inc_Basic.h"//基本库
#include "Power.h"
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：delay_Power

 * 函数功能：电源配置操作延时

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void delay_Power()
{
 	_nop_();
	_nop_();
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：LvdfInit

 * 函数功能：低电压中断初始化

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void LvdfInit()
{
 	ELVD = 1;//开启低电压中断
	IP |= 0x40;//设低电压中断最高级
	IPH |= 0x40;//设低电压中断最高级
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：LvdfInerrupt

 * 函数功能：低电压中断函数

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void LvdfInerrupt() interrupt 6
{
	 PCON &= 0xDF;
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_Low

 * 函数功能：低电压中断函数

 * 输入参数：无

 * 输出参数：无

 * 注    意：选择此模式进入掉电模式后,VCC 管脚的电压不能有较大波动,否则对 MCU 内核可能会有不良影响
------------------------------------------------------------------------------------------------------------------------*/
void Power_Low()
{
 	VOCTRL |= 0x80;
	delay_Power();
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_High

 * 函数功能：使单片机进入高功耗模式

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void Power_High()
{
	VOCTRL &= 0x7F;
	delay_Power();	
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_PD

 * 函数功能：使单片机进入掉电模式

 * 输入参数：无

 * 输出参数：无

 * 注    意：掉电模式(CPU不工作,外设不工作)
------------------------------------------------------------------------------------------------------------------------*/
void Power_PD()
{
 	Power_High();
	PCON |= 0x02;
	delay_Power();
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_IDL

 * 函数功能：使单片机进入空闲模式

 * 输入参数：无

 * 输出参数：无

 * 注    意：空闲模式(CPU不工作,外设工作)
------------------------------------------------------------------------------------------------------------------------*/
void Power_IDL()
{
	Power_High();
	PCON |= 0x01;
	delay_Power();
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_ISP

 * 函数功能：使单片机从ISP区启动

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void Power_ISP()
{
	ISP_CONTR = 0x60;	
}
/*------------------------------------------------------------------------------------------------------------------------
 * 函数名称：Power_RST

 * 函数功能：使单片机复位

 * 输入参数：无

 * 输出参数：无

 * 注    意：无
------------------------------------------------------------------------------------------------------------------------*/
void Power_RST()
{
	ISP_CONTR = 0x20;	
}
/*------------------------------------------------------------------------------------------------------------------------
                                                  END
------------------------------------------------------------------------------------------------------------------------*/